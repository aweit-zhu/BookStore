<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>購物車</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="./output.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
</head>

<body class="overflow-auto" style="min-width: 600px;">
    <!-- Header -->
    <div id="header" class="sticky top-0 bg-white z-40"></div>

    <section class="section h-full w-2/3 mt-10">
        <div class="flex min-w-11 mx-auto  relative justify-between items-center">
            <p class="rounded-full border-2 px-3 py-1 text-nowrap text-lg font-bold bg-green-300">1</p>
            <hr class="border-2 border-green-600 w-full"/>
            <p class="rounded-full border-2 px-3 py-1 text-nowrap text-lg font-bold">2</p>
            <hr class="border-2 border-green-600 w-full"/>
            <p class="rounded-full border-2 px-3 py-1 text-nowrap text-lg font-bold">3</p>
            <p class="absolute left-1/4  -translate-x-1 transform top-0 text-sm">購物明細</p>
            <p class="absolute right-1/4 -translatex-1 transform top-0 text-sm">付款</p>
        </div>
        <table class="table-fixed mt-8 mx-auto text-center">
            <thead>
              <tr>
                <th class="pb-4 text-nowrap">序號</th>
                <th class="pb-4 text-nowrap">商品明細</th>
                <th class="pb-4 text-nowrap">數量</th>
                <th class="pb-4 text-nowrap">小計</th>
                <th class="pb-4 text-nowrap">庫存</th>
                <th class="pb-4 text-nowrap">變更明細</th>
              </tr>
            </thead>
            <tbody>
              <tr id="cartItem-row">
                <td colspan="6" class="text-end pt-8">
                    <button class="btn-primary">付款</button>
                </td>
              </tr>
            </tbody>
          </table>
    </section>

    <!-- footer -->
    <div id="footer"></div>

    <script type="module">
        import { slide,currency } from '/src/js/util.js';
        import { books } from '/src/js/data.js';
        import { cartItems } from '/src/js/cart.js';
        
        $('#header').load('/src/fragements/header.html',function() {
            $('#cartItemsCtn').text(cartItems.length);
        });
        $('#footer').load('/src/fragements/footer.html');
        
        cartItems.map(bookId => {
            let book = [...books].filter(b => b.id == bookId)[0];
            $('#cartItem-row').before(
              `
                <tr>
                    <td class="w-10">${book.id}</td>
                    <td class="w-40">${book.name}</td>
                    <td class="w-20">1</td>
                    <td class="w-20">${book.price}</td>
                    <td class="w-20">${book.stockQty}</td>
                    <td class="w-30"><button class="btn-success">修改</button></td>
                </tr>
              `
            );
        });

    </script>
</body>

</html>